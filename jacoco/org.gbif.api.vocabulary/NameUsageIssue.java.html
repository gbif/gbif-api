<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NameUsageIssue.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GBIF Common :: API</a> &gt; <a href="index.source.html" class="el_package">org.gbif.api.vocabulary</a> &gt; <span class="el_source">NameUsageIssue.java</span></div><h1>NameUsageIssue.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2020 Global Biodiversity Information Facility (GBIF)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.gbif.api.vocabulary;

import org.gbif.dwc.terms.DwcTerm;
import org.gbif.dwc.terms.GbifTerm;
import org.gbif.dwc.terms.Term;
import org.gbif.utils.AnnotationUtils;

import java.util.Arrays;
import java.util.Collections;
import java.util.HashSet;
import java.util.Set;

import static org.gbif.api.vocabulary.InterpretationRemarkSeverity.ERROR;
import static org.gbif.api.vocabulary.InterpretationRemarkSeverity.INFO;
import static org.gbif.api.vocabulary.InterpretationRemarkSeverity.WARNING;

/**
 * Enumeration of issues for each name usage record encountered during checklist processing.
 */
<span class="fc" id="L35">public enum NameUsageIssue implements InterpretationRemark {</span>
  /**
   * The value for dwc:parentNameUsageID could not be resolved.
   */
<span class="fc" id="L39">  PARENT_NAME_USAGE_ID_INVALID(ERROR, DwcTerm.parentNameUsageID),</span>

  /**
   * The value for dwc:acceptedNameUsageID could not be resolved.
   */
<span class="fc" id="L44">  ACCEPTED_NAME_USAGE_ID_INVALID(ERROR, DwcTerm.acceptedNameUsageID),</span>

  /**
   * The value for dwc:originalNameUsageID could not be resolved.
   */
<span class="fc" id="L49">  ORIGINAL_NAME_USAGE_ID_INVALID(ERROR, DwcTerm.originalNameUsageID),</span>

  /**
   * Synonym lacking an accepted name.
   */
<span class="fc" id="L54">  ACCEPTED_NAME_MISSING(DwcTerm.taxonomicStatus, DwcTerm.acceptedNameUsageID, DwcTerm.acceptedNameUsage),</span>

  /**
   * dwc:taxonRank could not be interpreted
   */
<span class="fc" id="L59">  RANK_INVALID(DwcTerm.taxonRank),</span>

  /**
   * dwc:nomenclaturalStatus could not be interpreted
   */
<span class="fc" id="L64">  NOMENCLATURAL_STATUS_INVALID(DwcTerm.nomenclaturalStatus),</span>

  /**
   * dwc:taxonomicStatus could not be interpreted
   */
<span class="fc" id="L69">  TAXONOMIC_STATUS_INVALID(DwcTerm.taxonomicStatus),</span>

  /**
   * The scientific name was assembled from the individual name parts and not given as a whole string.
   */
<span class="fc" id="L74">  SCIENTIFIC_NAME_ASSEMBLED(INFO, DwcTerm.scientificName, DwcTerm.genus, DwcTerm.specificEpithet, DwcTerm.infraspecificEpithet, DwcTerm.taxonRank, DwcTerm.scientificNameAuthorship, DwcTerm.namePublishedInYear),</span>

  /**
   * If a synonym points to another synonym as its accepted taxon the chain is resolved.
   */
<span class="fc" id="L79">  CHAINED_SYNOYM(DwcTerm.acceptedNameUsageID, DwcTerm.acceptedNameUsage),</span>

  /**
   * The authorship of the original name does not match the authorship in brackets of the actual name.
   */
<span class="fc" id="L84">  BASIONYM_AUTHOR_MISMATCH(DwcTerm.scientificName, DwcTerm.scientificNameAuthorship, DwcTerm.originalNameUsageID, DwcTerm.originalNameUsage),</span>

<span class="fc" id="L86">  TAXONOMIC_STATUS_MISMATCH(DwcTerm.taxonomicStatus, DwcTerm.acceptedNameUsageID, DwcTerm.acceptedNameUsage),</span>

  /**
   * The child parent classification resulted into a cycle that needed to be resolved/cut.
   */
<span class="fc" id="L91">  PARENT_CYCLE(ERROR, DwcTerm.parentNameUsageID, DwcTerm.parentNameUsage),</span>

  /**
   * The given ranks of the names in the classification hierarchy do not follow the hierarchy of ranks.
   */
<span class="fc" id="L96">  CLASSIFICATION_RANK_ORDER_INVALID(ERROR, DwcTerm.parentNameUsageID, DwcTerm.parentNameUsage, DwcTerm.taxonRank),</span>

  /**
   * The denormalized classification could not be applied to the name usage.
   * For example if the id based classification has no ranks.
   */
<span class="fc" id="L102">  CLASSIFICATION_NOT_APPLIED(DwcTerm.kingdom, DwcTerm.phylum, DwcTerm.class_, DwcTerm.order, DwcTerm.family, DwcTerm.genus),</span>

  /**
   * At least one vernacular name extension record attached to this name usage is invalid.
   */
<span class="fc" id="L107">  VERNACULAR_NAME_INVALID(DwcTerm.vernacularName),</span>

  /**
   * At least one description extension record attached to this name usage is invalid.
   */
<span class="fc" id="L112">  DESCRIPTION_INVALID(GbifTerm.Description),</span>

  /**
   * At least one distribution extension record attached to this name usage is invalid.
   */
<span class="fc" id="L117">  DISTRIBUTION_INVALID(GbifTerm.Distribution),</span>

  /**
   * At least one species profile extension record attached to this name usage is invalid.
   */
<span class="fc" id="L122">  SPECIES_PROFILE_INVALID(GbifTerm.SpeciesProfile),</span>

  /**
   * At least one multimedia extension record attached to this name usage is invalid.
   * This covers multimedia coming in through various extensions including
   * Audubon core, Simple images or multimedia or EOL media.
   */
<span class="fc" id="L129">  MULTIMEDIA_INVALID(GbifTerm.Multimedia),</span>

  /**
   * At least one bibliographic reference extension record attached to this name usage is invalid.
   */
<span class="fc" id="L134">  BIB_REFERENCE_INVALID(GbifTerm.Reference),</span>

  /**
   * At least one alternative identifier extension record attached to this name usage is invalid.
   */
<span class="fc" id="L139">  ALT_IDENTIFIER_INVALID(GbifTerm.Identifier),</span>

  /**
   * Name usage could not be matched to the GBIF backbone.
   */
<span class="fc" id="L144">  BACKBONE_MATCH_NONE(INFO, DwcTerm.scientificName, DwcTerm.scientificNameAuthorship, DwcTerm.kingdom, DwcTerm.taxonRank),</span>

  /**
   * Name usage could only be matched to the GBIF backbone using fuzzy matching.
   * @deprecated because there should be no fuzzy matching being used anymore for matching checklist names
   */
<span class="fc" id="L150">  @Deprecated</span>
  BACKBONE_MATCH_FUZZY(DwcTerm.scientificName, DwcTerm.scientificNameAuthorship, DwcTerm.kingdom, DwcTerm.taxonRank),

  /**
   * Name usage could only be matched to a GBIF backbone species, but was in fact a broader species aggregate/complex.
   * @see &lt;a href=&quot;https://github.com/gbif/portal-feedback/issues/2935&quot;&gt;gbif/portal-feedback#2935&lt;/a&gt;
   */
<span class="fc" id="L157">  BACKBONE_MATCH_AGGREGATE(DwcTerm.scientificName, DwcTerm.scientificNameAuthorship, DwcTerm.kingdom, DwcTerm.taxonRank),</span>

  /**
   * Synonym has a verbatim accepted name which is not unique and refers to several records.
   */
<span class="fc" id="L162">  ACCEPTED_NAME_NOT_UNIQUE(DwcTerm.acceptedNameUsage),</span>

  /**
   * Record has a verbatim parent name which is not unique and refers to several records.
   */
<span class="fc" id="L167">  PARENT_NAME_NOT_UNIQUE(DwcTerm.parentNameUsage),</span>

  /**
   * Record has a verbatim original name (basionym) which is not unique and refers to several records.
   */
<span class="fc" id="L172">  ORIGINAL_NAME_NOT_UNIQUE(DwcTerm.originalNameUsage),</span>

  /**
   * There were problems representing all name usage relationships,
   * i.e. the link to the parent, accepted and/or original name.
   * The interpreted record in ChecklistBank is lacking some of the original source relation.
   */
<span class="fc" id="L179">  RELATIONSHIP_MISSING(DwcTerm.parentNameUsageID, DwcTerm.acceptedNameUsageID, DwcTerm.originalNameUsageID, DwcTerm.parentNameUsage, DwcTerm.acceptedNameUsage, DwcTerm.originalNameUsage),</span>

  /**
   * Record has a original name (basionym) relationship which was derived from name &amp; authorship comparison, but did not exist explicitly in the data.
   * This should only be flagged in programmatically generated GBIF backbone usages.
   * GBIF backbone specific issue.
   */
<span class="fc" id="L186">  ORIGINAL_NAME_DERIVED(INFO),</span>

  /**
   * There have been more than one accepted name in a homotypical basionym group of names.
   * GBIF backbone specific issue.
   */
<span class="fc" id="L192">  CONFLICTING_BASIONYM_COMBINATION(),</span>

  /**
   * The group (currently only genera are tested) are lacking any accepted species
   * GBIF backbone specific issue.
   */
<span class="fc" id="L198">  NO_SPECIES(INFO),</span>

  /**
   * The (accepted) bi/trinomial name does not match the parent name and should be recombined into the parent genus/species.
   * For example the species Picea alba with a parent genus Abies is a mismatch and should be replaced by Abies alba.
   * GBIF backbone specific issue.
   */
<span class="fc" id="L205">  NAME_PARENT_MISMATCH(),</span>

  /**
   * A potential orthographic variant exists in the backbone.
   * GBIF backbone specific issue.
   */
<span class="fc" id="L211">  ORTHOGRAPHIC_VARIANT(INFO),</span>

  /**
   * A not synonymized homonym exists for this name in some other backbone source which have been ignored at build time.
   */
<span class="fc" id="L216">  HOMONYM(INFO, DwcTerm.scientificName),</span>

  /**
   * A bi/trinomial name published earlier than the parent genus was published.
   * This might indicate that the name should rather be a recombination.
   */
<span class="fc" id="L222">  PUBLISHED_BEFORE_GENUS(DwcTerm.scientificName, DwcTerm.scientificNameAuthorship, DwcTerm.namePublishedInYear, DwcTerm.genus, DwcTerm.parentNameUsageID, DwcTerm.parentNameUsage),</span>

  /**
   * The scientific name string could not be parsed at all, but appears to be a parsable name type,
   * i.e. it is not classified as a virus or hybrid formula.
   */
<span class="fc" id="L228">  UNPARSABLE(DwcTerm.scientificName),</span>

  /**
   * The beginning of the scientific name string was parsed,
   * but there is additional information in the string that was not understood.
   */
<span class="fc" id="L234">  PARTIALLY_PARSABLE(DwcTerm.scientificName);</span>


  private final Set&lt;Term&gt; related;
  private final InterpretationRemarkSeverity severity;
  private final boolean isDeprecated;

  NameUsageIssue(Term ... related) {
<span class="fc" id="L242">    this(WARNING, related);</span>
<span class="fc" id="L243">  }</span>

<span class="fc" id="L245">  NameUsageIssue(InterpretationRemarkSeverity severity, Term... related) {</span>
<span class="pc bpc" id="L246" title="1 of 2 branches missed.">    if (related == null) {</span>
<span class="nc" id="L247">      this.related = Collections.emptySet();</span>
    } else {
<span class="fc" id="L249">      this.related = Collections.unmodifiableSet(new HashSet&lt;&gt;(Arrays.asList(related)));</span>
    }
<span class="fc" id="L251">    this.severity = severity;</span>
<span class="fc" id="L252">    this.isDeprecated = AnnotationUtils.isFieldDeprecated(NameUsageIssue.class, this.name());</span>
<span class="fc" id="L253">  }</span>

  @Override
  public String getId() {
<span class="fc" id="L257">    return name();</span>
  }

  @Override
  public Set&lt;Term&gt; getRelatedTerms() {
<span class="nc" id="L262">    return related;</span>
  }

  @Override
  public InterpretationRemarkSeverity getSeverity(){
<span class="fc" id="L267">    return severity;</span>
  }

  @Override
  public boolean isDeprecated(){
<span class="nc" id="L272">    return isDeprecated;</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>