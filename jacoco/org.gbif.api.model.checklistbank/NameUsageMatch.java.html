<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NameUsageMatch.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GBIF Common :: API</a> &gt; <a href="index.source.html" class="el_package">org.gbif.api.model.checklistbank</a> &gt; <span class="el_source">NameUsageMatch.java</span></div><h1>NameUsageMatch.java</h1><pre class="source lang-java linenums">/*
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.gbif.api.model.checklistbank;

import org.gbif.api.model.common.LinneanClassification;
import org.gbif.api.model.common.LinneanClassificationKeys;
import org.gbif.api.util.ClassificationUtils;
import org.gbif.api.vocabulary.Rank;
import org.gbif.api.vocabulary.TaxonomicStatus;

import java.io.Serializable;
import java.util.List;
import java.util.Objects;
import java.util.StringJoiner;

import jakarta.annotation.Nullable;
import jakarta.validation.constraints.Max;
import jakarta.validation.constraints.Min;

import com.fasterxml.jackson.annotation.JsonProperty;

import io.swagger.v3.oas.annotations.media.Schema;

/**
 * The resulting lookup of a name usage match.
 * A single name usage key with its Linnean classification and a confidence value for the match.
 */
@SuppressWarnings(&quot;unused&quot;)
<span class="nc" id="L40">public class NameUsageMatch implements LinneanClassification, LinneanClassificationKeys, Serializable {</span>

  private static final long serialVersionUID = -8927655067465421358L;

  private Integer usageKey;
  private Integer acceptedUsageKey;
  private String scientificName;
  private String canonicalName;
  private Rank rank;
  private TaxonomicStatus status; // ACCEPTED, SYNONYM or DOUBTFUL only!
  private Integer confidence;
  private String note;
<span class="nc" id="L52">  private MatchType matchType = MatchType.NONE;</span>
  private List&lt;NameUsageMatch&gt; alternatives;
  // for LinneanClassification
  private String kingdom;
  private String phylum;
  @JsonProperty(&quot;class&quot;)
  private String clazz;
  private String order;
  private String family;
  private String genus;
  private String subgenus;
  private String species;
  // for LinneanClassificationKeys
  private Integer kingdomKey;
  private Integer phylumKey;
  private Integer classKey;
  private Integer orderKey;
  private Integer familyKey;
  private Integer genusKey;
  private Integer subgenusKey;
  private Integer speciesKey;

  /**
   * The confidence that the lookup was correct.
   * A value between 0 and 100 with higher values being better matches.
   *
   * @return the lookup confidence
   */
  @Schema(description = &quot;The confidence that the lookup was correct.\n\n&quot; +
    &quot;A value between 0 and 100 with higher values being better matches.&quot;)
  @Min(0)
  @Max(100)
  public Integer getConfidence() {
<span class="nc" id="L85">    return confidence;</span>
  }

  /**
   * @param confidence the confidence to set
   */
  public void setConfidence(Integer confidence) {
<span class="nc" id="L92">    this.confidence = confidence;</span>
<span class="nc" id="L93">  }</span>

  /**
   * @return the type of match for this result
   */
  @Schema(description = &quot;The type of match for this result.&quot;)
  public MatchType getMatchType() {
<span class="nc" id="L100">    return matchType;</span>
  }

  public void setMatchType(MatchType matchType) {
<span class="nc" id="L104">    this.matchType = matchType;</span>
<span class="nc" id="L105">  }</span>

  /**
   * @return the rank of the matching usage
   */
  @Schema(description = &quot;The rank of the matching usage.&quot;)
  @Nullable
  public Rank getRank() {
<span class="nc" id="L113">    return rank;</span>
  }

  public void setRank(Rank rank) {
<span class="nc" id="L117">    this.rank = rank;</span>
<span class="nc" id="L118">  }</span>

  /**
   * The scientific name of the matched name usage.
   *
   * @return the scientific name of the matched usage
   */
  @Schema(description = &quot;The scientific name of the matched name usage.&quot;)
  @Nullable
  public String getScientificName() {
<span class="nc" id="L128">    return scientificName;</span>
  }

  public void setScientificName(String scientificName) {
<span class="nc" id="L132">    this.scientificName = scientificName;</span>
<span class="nc" id="L133">  }</span>

  /**
   * The name usage key of the name usage that has been matched.
   *
   * @return the usageKey
   */
  @Schema(description = &quot;The name usage key of the name usage that has been matched.&quot;)
  @Nullable
  public Integer getUsageKey() {
<span class="nc" id="L143">    return usageKey;</span>
  }

  /**
   * @param usageKey the usageKey to set
   */
  public void setUsageKey(Integer usageKey) {
<span class="nc" id="L150">    this.usageKey = usageKey;</span>
<span class="nc" id="L151">  }</span>

  /**
   * The key of the accepted name usage in case the matched usage was a synonym.
   */
  @Schema(description = &quot;The key of the accepted name usage in case the matched usage was a synonym.&quot;)
  @Nullable
  public Integer getAcceptedUsageKey() {
<span class="nc" id="L159">    return acceptedUsageKey;</span>
  }

  public void setAcceptedUsageKey(Integer acceptedUsageKey) {
<span class="nc" id="L163">    this.acceptedUsageKey = acceptedUsageKey;</span>
<span class="nc" id="L164">  }</span>

  /**
   * @return true if it's a synonym
   */
  @Schema(description = &quot;True if the match name is a synonym.&quot;)
  public boolean isSynonym() {
<span class="nc bnc" id="L171" title="All 4 branches missed.">    return status != null &amp;&amp; status.isSynonym();</span>
  }

  /**
   * The taxonomic status of the backbone usage. This field is required and only 3 values are allowed:
   * &lt;ul&gt;
   *   &lt;li&gt;accepted: regular accepted taxon&lt;/li&gt;
   *   &lt;li&gt;synonym: any kind of synonym&lt;/li&gt;
   *   &lt;li&gt;doubtful: treated as accepted but in doubt for some reason&lt;/li&gt;
   * &lt;/ul&gt;
   */
  @Schema(description = &quot;The taxonomic status of the backbone usage.&quot;)
  public TaxonomicStatus getStatus() {
<span class="nc" id="L184">    return status;</span>
  }

  public void setStatus(TaxonomicStatus status) {
<span class="nc" id="L188">    this.status = status;</span>
<span class="nc" id="L189">  }</span>

  @Schema(description = &quot;Matched name's kingdom.&quot;)
  @Override
  @Nullable
  public String getKingdom() {
<span class="nc" id="L195">    return kingdom;</span>
  }

  @Override
  public void setKingdom(String kingdom) {
<span class="nc" id="L200">    this.kingdom = kingdom;</span>
<span class="nc" id="L201">  }</span>

  @Schema(description = &quot;Matched name's phylum.&quot;)
  @Override
  @Nullable
  public String getPhylum() {
<span class="nc" id="L207">    return phylum;</span>
  }

  @Override
  public void setPhylum(String phylum) {
<span class="nc" id="L212">    this.phylum = phylum;</span>
<span class="nc" id="L213">  }</span>

  @Schema(description = &quot;Matched name's class.&quot;)
  @Override
  @Nullable
  public String getClazz() {
<span class="nc" id="L219">    return clazz;</span>
  }

  @Override
  public void setClazz(String clazz) {
<span class="nc" id="L224">    this.clazz = clazz;</span>
<span class="nc" id="L225">  }</span>

  @Schema(description = &quot;Matched name's order.&quot;)
  @Override
  @Nullable
  public String getOrder() {
<span class="nc" id="L231">    return order;</span>
  }

  @Override
  public void setOrder(String order) {
<span class="nc" id="L236">    this.order = order;</span>
<span class="nc" id="L237">  }</span>

  @Schema(description = &quot;Matched name's family.&quot;)
  @Override
  @Nullable
  public String getFamily() {
<span class="nc" id="L243">    return family;</span>
  }

  @Override
  public void setFamily(String family) {
<span class="nc" id="L248">    this.family = family;</span>
<span class="nc" id="L249">  }</span>

  @Schema(description = &quot;Matched name's genus.&quot;)
  @Override
  @Nullable
  public String getGenus() {
<span class="nc" id="L255">    return genus;</span>
  }

  @Override
  public void setGenus(String genus) {
<span class="nc" id="L260">    this.genus = genus;</span>
<span class="nc" id="L261">  }</span>

  @Schema(description = &quot;Matched name's subgenus.&quot;)
  @Override
  @Nullable
  public String getSubgenus() {
<span class="nc" id="L267">    return subgenus;</span>
  }

  @Override
  public void setSubgenus(String subgenus) {
<span class="nc" id="L272">    this.subgenus = subgenus;</span>
<span class="nc" id="L273">  }</span>

  @Schema(description = &quot;Matched name's species.&quot;)
  @Override
  @Nullable
  public String getSpecies() {
<span class="nc" id="L279">    return species;</span>
  }

  @Override
  public void setSpecies(String species) {
<span class="nc" id="L284">    this.species = species;</span>
<span class="nc" id="L285">  }</span>

  @Schema(description = &quot;Usage key of the kingdom of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getKingdomKey() {
<span class="nc" id="L291">    return kingdomKey;</span>
  }

  @Override
  public void setKingdomKey(Integer kingdomKey) {
<span class="nc" id="L296">    this.kingdomKey = kingdomKey;</span>
<span class="nc" id="L297">  }</span>

  @Schema(description = &quot;Usage key of the phylum of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getPhylumKey() {
<span class="nc" id="L303">    return phylumKey;</span>
  }

  @Override
  public void setPhylumKey(Integer phylumKey) {
<span class="nc" id="L308">    this.phylumKey = phylumKey;</span>
<span class="nc" id="L309">  }</span>

  @Schema(description = &quot;Usage key of the class of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getClassKey() {
<span class="nc" id="L315">    return classKey;</span>
  }

  @Override
  public void setClassKey(Integer classKey) {
<span class="nc" id="L320">    this.classKey = classKey;</span>
<span class="nc" id="L321">  }</span>

  @Schema(description = &quot;Usage key of the order of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getOrderKey() {
<span class="nc" id="L327">    return orderKey;</span>
  }

  @Override
  public void setOrderKey(Integer orderKey) {
<span class="nc" id="L332">    this.orderKey = orderKey;</span>
<span class="nc" id="L333">  }</span>

  @Schema(description = &quot;Usage key of the family of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getFamilyKey() {
<span class="nc" id="L339">    return familyKey;</span>
  }

  @Override
  public void setFamilyKey(Integer familyKey) {
<span class="nc" id="L344">    this.familyKey = familyKey;</span>
<span class="nc" id="L345">  }</span>

  @Schema(description = &quot;Usage key of the genus of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getGenusKey() {
<span class="nc" id="L351">    return genusKey;</span>
  }

  @Override
  public void setGenusKey(Integer genusKey) {
<span class="nc" id="L356">    this.genusKey = genusKey;</span>
<span class="nc" id="L357">  }</span>

  @Schema(description = &quot;Usage key of the subgenus of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getSubgenusKey() {
<span class="nc" id="L363">    return subgenusKey;</span>
  }

  @Override
  public void setSubgenusKey(Integer subgenusKey) {
<span class="nc" id="L368">    this.subgenusKey = subgenusKey;</span>
<span class="nc" id="L369">  }</span>

  @Schema(description = &quot;Usage key of the species of the matched name.&quot;)
  @Override
  @Nullable
  public Integer getSpeciesKey() {
<span class="nc" id="L375">    return speciesKey;</span>
  }

  @Override
  public void setSpeciesKey(Integer speciesKey) {
<span class="nc" id="L380">    this.speciesKey = speciesKey;</span>
<span class="nc" id="L381">  }</span>

  @Schema(description = &quot;Usage key of the kingdom of the matched name.&quot;)
  @Override
  @Nullable
  public String getHigherRank(Rank rank) {
<span class="nc" id="L387">    return ClassificationUtils.getHigherRank(this, rank);</span>
  }

  @Override
  public Integer getHigherRankKey(Rank rank) {
<span class="nc" id="L392">    return ClassificationUtils.getHigherRankKey(this, rank);</span>
  }

  @Nullable
  public String getCanonicalName() {
<span class="nc" id="L397">    return canonicalName;</span>
  }

  public void setCanonicalName(String canonicalName) {
<span class="nc" id="L401">    this.canonicalName = canonicalName;</span>
<span class="nc" id="L402">  }</span>

  /**
   * Optional notes on the matching.
   */
  @Nullable
  public String getNote() {
<span class="nc" id="L409">    return note;</span>
  }

  public void setNote(String note) {
<span class="nc" id="L413">    this.note = note;</span>
<span class="nc" id="L414">  }</span>

  /**
   * @return a list of alternative matches considered
   */
  @Nullable
  public List&lt;NameUsageMatch&gt; getAlternatives() {
<span class="nc" id="L421">    return alternatives;</span>
  }

  public void setAlternatives(List&lt;NameUsageMatch&gt; alternatives) {
<span class="nc" id="L425">    this.alternatives = alternatives;</span>
<span class="nc" id="L426">  }</span>

  @Override
  public boolean equals(Object o) {
<span class="nc bnc" id="L430" title="All 2 branches missed.">    if (this == o) {</span>
<span class="nc" id="L431">      return true;</span>
    }
<span class="nc bnc" id="L433" title="All 4 branches missed.">    if (o == null || getClass() != o.getClass()) {</span>
<span class="nc" id="L434">      return false;</span>
    }
<span class="nc" id="L436">    NameUsageMatch that = (NameUsageMatch) o;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">    return Objects.equals(usageKey, that.usageKey) &amp;&amp;</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">      Objects.equals(acceptedUsageKey, that.acceptedUsageKey) &amp;&amp;</span>
<span class="nc bnc" id="L439" title="All 2 branches missed.">      Objects.equals(scientificName, that.scientificName) &amp;&amp;</span>
<span class="nc bnc" id="L440" title="All 6 branches missed.">      Objects.equals(canonicalName, that.canonicalName) &amp;&amp;</span>
      rank == that.rank &amp;&amp;
      status == that.status &amp;&amp;
<span class="nc bnc" id="L443" title="All 2 branches missed.">      Objects.equals(confidence, that.confidence) &amp;&amp;</span>
<span class="nc bnc" id="L444" title="All 4 branches missed.">      Objects.equals(note, that.note) &amp;&amp;</span>
      matchType == that.matchType &amp;&amp;
<span class="nc bnc" id="L446" title="All 2 branches missed.">      Objects.equals(alternatives, that.alternatives) &amp;&amp;</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">      Objects.equals(kingdom, that.kingdom) &amp;&amp;</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">      Objects.equals(phylum, that.phylum) &amp;&amp;</span>
<span class="nc bnc" id="L449" title="All 2 branches missed.">      Objects.equals(clazz, that.clazz) &amp;&amp;</span>
<span class="nc bnc" id="L450" title="All 2 branches missed.">      Objects.equals(order, that.order) &amp;&amp;</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">      Objects.equals(family, that.family) &amp;&amp;</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">      Objects.equals(genus, that.genus) &amp;&amp;</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">      Objects.equals(subgenus, that.subgenus) &amp;&amp;</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">      Objects.equals(species, that.species) &amp;&amp;</span>
<span class="nc bnc" id="L455" title="All 2 branches missed.">      Objects.equals(kingdomKey, that.kingdomKey) &amp;&amp;</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">      Objects.equals(phylumKey, that.phylumKey) &amp;&amp;</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">      Objects.equals(classKey, that.classKey) &amp;&amp;</span>
<span class="nc bnc" id="L458" title="All 2 branches missed.">      Objects.equals(orderKey, that.orderKey) &amp;&amp;</span>
<span class="nc bnc" id="L459" title="All 2 branches missed.">      Objects.equals(familyKey, that.familyKey) &amp;&amp;</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">      Objects.equals(genusKey, that.genusKey) &amp;&amp;</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">      Objects.equals(subgenusKey, that.subgenusKey) &amp;&amp;</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">      Objects.equals(speciesKey, that.speciesKey);</span>
  }

  @Override
  public int hashCode() {
<span class="nc" id="L467">    return Objects</span>
<span class="nc" id="L468">      .hash(usageKey, acceptedUsageKey, scientificName, canonicalName, rank, status, confidence,</span>
        note, matchType, alternatives, kingdom, phylum, clazz, order, family, genus, subgenus,
        species, kingdomKey, phylumKey, classKey, orderKey, familyKey, genusKey, subgenusKey,
        speciesKey);
  }

  @Override
  public String toString() {
<span class="nc" id="L476">    return new StringJoiner(&quot;, &quot;, NameUsageMatch.class.getSimpleName() + &quot;[&quot;, &quot;]&quot;)</span>
<span class="nc" id="L477">      .add(&quot;usageKey=&quot; + usageKey)</span>
<span class="nc" id="L478">      .add(&quot;acceptedUsageKey=&quot; + acceptedUsageKey)</span>
<span class="nc" id="L479">      .add(&quot;scientificName='&quot; + scientificName + &quot;'&quot;)</span>
<span class="nc" id="L480">      .add(&quot;canonicalName='&quot; + canonicalName + &quot;'&quot;)</span>
<span class="nc" id="L481">      .add(&quot;rank=&quot; + rank)</span>
<span class="nc" id="L482">      .add(&quot;status=&quot; + status)</span>
<span class="nc" id="L483">      .add(&quot;confidence=&quot; + confidence)</span>
<span class="nc" id="L484">      .add(&quot;note='&quot; + note + &quot;'&quot;)</span>
<span class="nc" id="L485">      .add(&quot;matchType=&quot; + matchType)</span>
<span class="nc" id="L486">      .add(&quot;alternatives=&quot; + alternatives)</span>
<span class="nc" id="L487">      .add(&quot;kingdom='&quot; + kingdom + &quot;'&quot;)</span>
<span class="nc" id="L488">      .add(&quot;phylum='&quot; + phylum + &quot;'&quot;)</span>
<span class="nc" id="L489">      .add(&quot;clazz='&quot; + clazz + &quot;'&quot;)</span>
<span class="nc" id="L490">      .add(&quot;order='&quot; + order + &quot;'&quot;)</span>
<span class="nc" id="L491">      .add(&quot;family='&quot; + family + &quot;'&quot;)</span>
<span class="nc" id="L492">      .add(&quot;genus='&quot; + genus + &quot;'&quot;)</span>
<span class="nc" id="L493">      .add(&quot;subgenus='&quot; + subgenus + &quot;'&quot;)</span>
<span class="nc" id="L494">      .add(&quot;species='&quot; + species + &quot;'&quot;)</span>
<span class="nc" id="L495">      .add(&quot;kingdomKey=&quot; + kingdomKey)</span>
<span class="nc" id="L496">      .add(&quot;phylumKey=&quot; + phylumKey)</span>
<span class="nc" id="L497">      .add(&quot;classKey=&quot; + classKey)</span>
<span class="nc" id="L498">      .add(&quot;orderKey=&quot; + orderKey)</span>
<span class="nc" id="L499">      .add(&quot;familyKey=&quot; + familyKey)</span>
<span class="nc" id="L500">      .add(&quot;genusKey=&quot; + genusKey)</span>
<span class="nc" id="L501">      .add(&quot;subgenusKey=&quot; + subgenusKey)</span>
<span class="nc" id="L502">      .add(&quot;speciesKey=&quot; + speciesKey)</span>
<span class="nc" id="L503">      .toString();</span>
  }

<span class="nc" id="L506">  public enum MatchType {</span>

    /**
     * An exact, straight match.
     */
<span class="nc" id="L511">    EXACT,</span>

    /**
     * A fuzzy, non exact match.
     */
<span class="nc" id="L516">    FUZZY,</span>

    /**
     * Matching on a higher rank than the lowest name given.
     */
<span class="nc" id="L521">    HIGHERRANK,</span>

    /**
     * Matching on species/infraspecies level
     * when the verbatim data in fact referred to a broader species aggregate/complex.
     * @see &lt;a href=&quot;https://github.com/gbif/portal-feedback/issues/2935&quot;&gt;gbif/portal-feedback#2935&lt;/a&gt;
     */
<span class="nc" id="L528">    AGGREGATE,</span>

    /**
     * No match or matching several names with too little information to keep apart.
     */
<span class="nc" id="L533">    NONE</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>